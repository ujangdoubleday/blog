{% extends "base.html" %}

{% block title %}{{ post.title }} - {{ config.site.title }}{% endblock %}
{% block description %}{{ post.description or post.excerpt or config.site.description }}{% endblock %}
{% block canonical %}{{ config.site.url }}{{ post.url }}{% endblock %}
{% block twitter_title %}{{ post.title }}{% endblock %}
{% block twitter_description %}{{ post.description or post.excerpt }}{% endblock %}

{% block og_meta %}
<meta property="og:type" content="article">
<meta property="og:title" content="{{ post.title }}">
<meta property="og:description" content="{{ post.description or post.excerpt }}">
<meta property="og:url" content="{{ config.site.url }}{{ post.url }}">
{% if post.image %}
<meta property="og:image" content="{{ config.site.url }}{{ post.image }}">
<meta property="og:image:alt" content="{{ post.title }}">
<meta name="twitter:image" content="{{ config.site.url }}{{ post.image }}">
{% endif %}
<meta property="article:published_time" content="{{ post.date.isoformat() }}">
<meta property="article:author" content="{{ post.author or config.site.author }}">
{% if post.category %}
<meta property="article:section" content="{{ post.category }}">
{% endif %}
{% endblock %}

{% block meta %}
<!-- Schema.org JSON-LD for BlogPosting -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ post.title }}",
  "description": "{{ post.description or post.excerpt }}",
  "url": "{{ config.site.url }}{{ post.url }}",
  "datePublished": "{{ post.date.isoformat() }}",
  "author": {
    "@type": "Person",
    "name": "{{ post.author or config.site.author }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ config.site.title }}",
    "url": "{{ config.site.url }}"
  }{% if post.image %},
  "image": {
    "@type": "ImageObject",
    "url": "{{ config.site.url }}{{ post.image }}"
  }{% endif %}
}
</script>
{% endblock %}

{% block content %}
<article class="post">
    <header class="post-header">
        <h1 class="post-title">{{ post.title }}</h1>
        <div class="post-meta">
            <time class="post-date" datetime="{{ post.date.isoformat() }}">
                {{ post.date.strftime('%B %d, %Y') }}
            </time>
            {% if post.author %}
            <span class="post-author">by {{ post.author }}</span>
            {% endif %}
            {% if post.reading_time %}
            <span class="post-reading-time">{{ post.reading_time }} min read</span>
            {% endif %}
        </div>
    </header>

    {% if post.image %}
    <figure class="post-image">
        {{ post.image | img_tag(post.title) | safe }}
    </figure>
    {% endif %}

    <section class="post-content">
        {{ post.content|safe }}
    </section>
</article>

<!-- post navigation outside article for reader mode -->
<nav class="post-navigation" hidden>
    {% if prev_post %}
    <a href="{{ prev_post.url }}" class="prev-post">
        ← {{ prev_post.title }}
    </a>
    {% endif %}
    {% if next_post %}
    <a href="{{ next_post.url }}" class="next-post">
        {{ next_post.title }} →
    </a>
    {% endif %}
</nav>
{% endblock %}
